# API Gateway Configuration

environment: development
port: 8080

server:
  read_timeout: 15s
  write_timeout: 15s
  idle_timeout: 60s

jwt:
  secret_key: "change-me-in-production"
  token_duration: 15m
  refresh_duration: 168h # 7 days
  issuer: "api-gateway"

rate_limit:
  enabled: true
  requests_per_min: 100
  burst_size: 20
  cleanup_interval: 1m

redis:
  host: "localhost"
  port: 6379
  password: ""
  db: 0

cors:
  allow_origins:
    - "*"
  allow_methods:
    - "GET"
    - "POST"
    - "PUT"
    - "PATCH"
    - "DELETE"
    - "OPTIONS"
  allow_headers:
    - "Origin"
    - "Content-Type"
    - "Accept"
    - "Authorization"
    - "X-Request-ID"
    - "Upgrade"
    - "Connection"
  expose_headers:
    - "Content-Length"
    - "X-Request-ID"
  allow_credentials: true
  max_age: 43200 # 12 hours

opa:
  enabled: true
  policy_path: "./policies"
  bundle_url: ""

# Backend services configuration (internal microservices)
# Add your services here following the pattern:
# services:
#   service_name:
#     base_url: "http://service-host:port"
#     timeout: 30s
services: {}

# External services configuration (host machine services via host.docker.internal)
# These services typically don't require authentication from the gateway
external_services:
  ollama:
    base_url: "http://host.docker.internal:11434"
    timeout: 600s  # LLM requests can take longer

  docker_registry:
    base_url: "http://host.docker.internal:5006"
    timeout: 60s

  frontend:
    base_url: "http://host.docker.internal:3000"
    timeout: 30s
    websocket: true  # Enable WebSocket upgrade for HMR
